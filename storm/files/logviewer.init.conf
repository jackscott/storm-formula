{%- from "storm/map.jinja" import meta with context %}
# apache storm logviewer upstart

description "apache storm logviewer"

start on runlevel [2345]
stop on runlevel [!2345]

respawn
respawn limit 5 30

setuid {{ user }}
setgid {{ user }}

env JAVA_HOME={{ java_home }}
env INSTALL_DIR={{ real_home }}
env LOCAL_CACHE={{ local_cache }}
env STORM_CONFIG_DIR={{ meta.conf_dir }}

start on net-device-up

script
  . /etc/default/storm-supervisor
  if [ "x$ENABLE" = "xyes" ]; then
    exec {{ real_home }}/bin/storm logviewer --config {{ meta.conf_dir }}/storm.yaml
  fi
end script

